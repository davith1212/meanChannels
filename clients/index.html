<!DOCTYPE html>
<html>
<head>
	<title>Instructor Login</title>

    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/js/bootstrap.min.js"></script>
	<script src="//ajax.googleapis.com/ajax/libs/angularjs/1.4.8/angular.min.js"></script>
    <script src="//ajax.googleapis.com/ajax/libs/angularjs/1.4.8/angular-route.min.js"></script>
    <script>

    var myApp = angular.module('myApp', ['ngRoute']);

    myApp.config(function ($routeProvider) {
        $routeProvider
            .when('/', {
                templateUrl: 'static/partials/info.html'
            })
            .when('/students', {
                templateUrl: 'static/partials/students.html'
            })            
            .when('/instructor', {
                templateUrl: 'static/partials/instructors.html'
            })
            .when('/apply', {
                templateUrl: 'static/partials/apply.html'
            })
            .when('/stripe', {
                templateUrl: 'static/partials/payment.html'
            })
            .when('/pop', {
                templateUrl: ' static/partials/populateData.html'
            })
            .when('/studentHome', {
                templateUrl: 'static/partials/student_Home.html'
            })
            .otherwise({
                redirectTo: '/'         
            }) 
    })
    myApp.factory('applyFactory', function($http) {
        var factory = {};

        factory.applyIndex = function (callback) {
            $http.get('/applyIndex').success(function(output) {
                applicants = output;
                console.log(applicants);
            })
        }
        factory.createApplicant = function (data, callback) {
            console.log('hi helloo');
            $http.post('/createApplicant', data).success( function (applicant) {
                callback(applicant);
            })
        }
        return factory;
    })
    myApp.factory('paymentFactory', function($http) {
        var factory = {};
        factory.paymentIndex = function (callback) { 
            $http.get('/paymentIndex').success(function(output) {
                payments = output;
                console.log(output, "index factory");
                callback(payments);
            })
        }
        factory.getPayment = function (data, callback) {
            $http.post('/getPayment', data).success(function (payment) {
                callback(payment);
            })
        }
        factory.removeData = function (callback) {
            $http.post('/removeData').success(function (payment) {
                callback(payment);
            })
        }
        return factory;
    })
    myApp.factory('studentFactory', function($http) {
        var factory = {};

        factory.studentIndex = function (callback) {
            $http.get('/studentIndex').success(function(output) {
                students = output;
                callback(students);
            })
        }
        factory.createStudent = function (data, callback) {
            $http.post('/createStudent', data).success(function (student) {
                callback(student);
            })
        }
        factory.removeStudent = function (callback) {
            $http.post('/removePost').success(function(student) {
                callback(student);
            })
        }
        return factory;
    })
    myApp.factory('classFactory', function ($http) {
        var factory = {}

        factory.classIndex = function (callback) {
            $http.get('/classIndex').success(function (xclass) {
                callback(xclass);
            })
        }
        factory.addClass = function (data, callback){
            $http.post('/addClass', data).success( function (xclass) {
                callback(xclass);
            })
        }
        factory.removeClass = function (callback) {
            $http.post('/removeClass').success( function (xclass) {
                callback(xclass);
            })
        }
        return factory;
    })
    myApp.controller('classController', function ($scope, classFactory) {
        classFactory.classIndex( function (data) {
            $scope.classes = data;
        })
        $scope.addClass = function () {
            var xclass = {
                name: $scope.xclass.name,
                date: $scope.xclass.date,
                type: $scope.xclass.type,
                description: $scope.xclass.description,
                size: 20
            }
            classFactory.addClass (xclass, function () {
                classFactory.classIndex (function (data) {
                    $scope.xclass = {};
                    $scope.classes = data;
                })
            })
        }
        $scope.removeClass = function () {
            classFactory.removeClass (function () {
                classFactory.classIndex (function (data) {
                    $scope.classes = data;
                })
            })
        }
    })
    myApp.controller('paymentController', function ($scope, paymentFactory) {
        paymentFactory.paymentIndex (function (data) {
            $scope.payments = data;
        })
        $scope.getPayment = function () {
            var payment = {
                payment: $scope.newPayment.payment
            }
            console.log(payment, "payment in front");
            paymentFactory.getPayment (payment, function ()  {
                paymentFactory.paymentIndex (function (data) {
                    console.log(data, "before scope end");
                    $scope.newPayment.payment = ''
                    $scope.payments = data;
                })
            })
        }
        $scope.removeData = function () {
            paymentFactory.removeData (function () {
                paymentFactory.paymentIndex (function (data) {
                    console.log('remove scope');
                    $scope.payments = data;
                })
            })
        }
    })
    myApp.controller('applyController', function ($scope, applyFactory) {
        applyFactory.applyIndex (function (data) {
            $scope.applicants = data;
        })
        $scope.apply = function () {
            var applicant = {
                first_name: $scope.newApplicant.first_name,
                last_name: $scope.newApplicant.last_name,
                address1: $scope.newApplicant.address1,
                address2: $scope.newApplicant.address2,
                city: $scope.newApplicant.city,
                state: $scope.newApplicant.state,
                zip: $scope.newApplicant.zip,
                phone: $scope.newApplicant.phone,
                email: $scope.newApplicant.email,
                password: $scope.newApplicant.password,
                bday: $scope.newApplicant.bday,
                class_type: $scope.newApplicant.class_type,
                class_description: $scope.newApplicant.class_description,
                certified_yes: $scope.newApplicant.certified_yes,
                certified_no: $scope.newApplicant.certified_no,
                date_certified: $scope.newApplicant.date_certified,
                cert_type: $scope.newApplicant.cert_type,
                training_school: $scope.newApplicant.training_school,
                currently_teaching_yes: $scope.newApplicant.currently_teaching_yes,
                currently_teaching_no: $scope.newApplicant.currently_teaching_no,
                time_teaching: $scope.newApplicant.time_teaching,
                experience: $scope.newApplicant.experience,
                references: $scope.newApplicant.references
            }
            applyFactory.createApplicant (applicant, function (){
                console.log(applicant, 'front end');
                applyFactory.applyIndex (function (data) {
                    $scope.newApplicant = '';
                    $scope.applicants = data;
                })
            })
        }
    })
    myApp.controller('studentController', function ($scope, studentFactory) {
        studentFactory.studentIndex (function (data) {
            $scope.students = data;
        })
        $scope.createStudent = function () {
            var student = {
                firstName: $scope.student.firstName,
                lastName: $scope.student.lastName,
                email: $scope.student.email,
                password: $scope.student.password
            }
            studentFactory.createStudent (student, function () {
                studentFactory.studentIndex (function (data) {
                    $scope.student ='',
                    $scope.students = data;
                })
            })
        }
        $scope.removeStudent = function (student) {
            studentFactory.removeStudent (student, function () {
                studentFactory.studentIndex (function (data) {
                    $scope.students = data;
                })
            })
        }
    })
    </script>
    <style type="text/css">
    	h3, h5{
    		font: papercraft;
    	}
    </style>
</head>
<body ng-app='myApp'>
<nav class="navbar navbar-default">
    <div class="container-fluid">
      <a class="navbar-brand" href="#/">ifART</a>
      <ul class="nav navbar-nav navbar-right">
        <li><a href="#/info">Home</a></li>
        <li><a href="#/students">Student Login</a></li>
        <li><a href="#/instructor">Instructor Login</a></li>
        <li><a href="#/apply">Teach</a></li>
        <li><a href="#/stripe">stripe</a></li>
        <li><a href="#/studentHome">Student Home</a></li>
        <li><a href="#/pop">Populate data</a></li>
      </ul>
    </div>
</nav>    
        <div id='view_box' ng-view=''></div>
</body>
</html>